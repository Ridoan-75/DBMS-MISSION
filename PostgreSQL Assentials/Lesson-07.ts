=========================================================================================
                            FOREIGN KEY EXPLAINED 
=========================================================================================

=========================================================================================
# 0. FOREIGN KEY ‡¶ï‡ßÄ?
=========================================================================================
Foreign Key ‡¶π‡¶≤‡ßã ‡¶è‡¶ï‡¶ü‡¶ø **database constraint** ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü ‚Äî
üëâ **‡¶¶‡ßÅ‡¶ü‡¶ø table ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá relationship ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø**

‡¶∏‡¶π‡¶ú ‡¶≠‡¶æ‡¶∑‡¶æ‡ßü:
- ‡¶è‡¶ï table ‡¶è‡¶∞ column
- ‡¶Ö‡¶®‡ßç‡¶Ø table ‡¶è‡¶∞ Primary Key ‡¶ï‡ßá reference ‡¶ï‡¶∞‡ßá

=========================================================================================
# 1. ‡¶ï‡ßá‡¶® Foreign Key ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞?
=========================================================================================
Foreign Key ‡¶õ‡¶æ‡ßú‡¶æ database ‡¶è ‚Äî
‚ùå Invalid data ‡¶¢‡ßÅ‡¶ï‡ßá ‡¶Ø‡ßá‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá  
‚ùå Relationship ‡¶≠‡ßá‡¶ô‡ßá ‡¶Ø‡¶æ‡ßü  
‚ùå Data inconsistency ‡¶π‡ßü  

Foreign Key ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßá:
‚úî Data integrity  
‚úî Relationship consistency  
‚úî Orphan record prevention  

=========================================================================================
# 2. Real-Life Example (Simple)
=========================================================================================
‡¶ß‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ï ‡¶¶‡ßÅ‡¶á‡¶ü‡¶æ table ‡¶Ü‡¶õ‡ßá:

----------------------------------
users (Parent Table)
----------------------------------
id | name
---|---------
1  | Rafi
2  | Sumi

----------------------------------
orders (Child Table)
----------------------------------
id | user_id | product
---|---------|---------
1  | 1       | Laptop
2  | 2       | Mouse

‡¶è‡¶ñ‡¶æ‡¶®‡ßá:
- users.id ‚Üí PRIMARY KEY
- orders.user_id ‚Üí FOREIGN KEY

=========================================================================================
# 3. Foreign Key Relationship Diagram
=========================================================================================
users.id  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂  orders.user_id

‡¶Æ‡¶æ‡¶®‡ßá:
- orders.user_id ‡¶è‡¶∞ value
- ‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á users.id ‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶π‡¶¨‡ßá

=========================================================================================
# 4. Foreign Key Create ‡¶ï‡¶∞‡¶æ‡¶∞ Syntax
=========================================================================================
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INT,
    product VARCHAR(50),
    CONSTRAINT fk_user
        FOREIGN KEY (user_id)
        REFERENCES users(id)
);

=========================================================================================
# 5. Foreign Key With INSERT Rule
=========================================================================================
‚ùå Invalid Insert:
-----------------------------------------------------------------------------------------
INSERT INTO orders (user_id, product)
VALUES (5, 'Keyboard');
-----------------------------------------------------------------------------------------

‡¶ï‡¶æ‡¶∞‡¶£:
- users table ‡¶è id = 5 ‡¶®‡ßá‡¶á
- Foreign Key violation error

‚úî Valid Insert:
-----------------------------------------------------------------------------------------
INSERT INTO orders (user_id, product)
VALUES (1, 'Keyboard');
-----------------------------------------------------------------------------------------

=========================================================================================
# 6. Parent vs Child Table
=========================================================================================
Parent Table:
- ‡¶Ø‡ßá‡¶ü‡¶æ‡¶∞ Primary Key reference ‡¶π‡ßü
- Example: users

Child Table:
- ‡¶Ø‡ßá‡¶ü‡¶æ‡¶§‡ßá Foreign Key ‡¶•‡¶æ‡¶ï‡ßá
- Example: orders

=========================================================================================
# 7. ON DELETE Behavior (VERY IMPORTANT üî•)
=========================================================================================
Foreign Key ‡¶è define ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡ßü ‚Äî
üëâ Parent row delete ‡¶π‡¶≤‡ßá child row ‡¶è‡¶∞ ‡¶ï‡ßÄ ‡¶π‡¶¨‡ßá

----------------------------------
ON DELETE CASCADE
----------------------------------
-----------------------------------------------------------------------------------------
FOREIGN KEY (user_id)
REFERENCES users(id)
ON DELETE CASCADE;
-----------------------------------------------------------------------------------------

Effect:
- users ‡¶•‡ßá‡¶ï‡ßá user delete ‡¶π‡¶≤‡ßá
- ‡¶§‡¶æ‡¶∞ ‡¶∏‡¶¨ orders auto delete ‡¶π‡¶¨‡ßá

----------------------------------
ON DELETE RESTRICT
----------------------------------
-----------------------------------------------------------------------------------------
ON DELETE RESTRICT;
-----------------------------------------------------------------------------------------

Effect:
- Parent delete ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ
- ‡¶Ø‡¶¶‡¶ø child row ‡¶•‡¶æ‡¶ï‡ßá

----------------------------------
ON DELETE SET NULL
----------------------------------
-----------------------------------------------------------------------------------------
ON DELETE SET NULL;
-----------------------------------------------------------------------------------------

Effect:
- Parent delete ‡¶π‡¶≤‡ßá
- child.user_id = NULL ‡¶π‡¶¨‡ßá

----------------------------------
ON DELETE NO ACTION
----------------------------------
- Default behavior
- Practically RESTRICT ‡¶è‡¶∞ ‡¶Æ‡¶§‡ßã

=========================================================================================
# 8. ON UPDATE Behavior
=========================================================================================
-----------------------------------------------------------------------------------------
FOREIGN KEY (user_id)
REFERENCES users(id)
ON UPDATE CASCADE;
-----------------------------------------------------------------------------------------

Effect:
- users.id change ‡¶π‡¶≤‡ßá
- orders.user_id auto update ‡¶π‡¶¨‡ßá

=========================================================================================
# 9. Add Foreign Key To Existing Table
=========================================================================================
-----------------------------------------------------------------------------------------
ALTER TABLE orders
ADD CONSTRAINT fk_user
FOREIGN KEY (user_id)
REFERENCES users(id);
-----------------------------------------------------------------------------------------

=========================================================================================
# 10. Drop Foreign Key
=========================================================================================
-----------------------------------------------------------------------------------------
ALTER TABLE orders
DROP CONSTRAINT fk_user;
-----------------------------------------------------------------------------------------

=========================================================================================
# 11. Foreign Key With Multiple Tables
=========================================================================================
Example:
- students
- courses
- enrollments

-----------------------------------------------------------------------------------------
CREATE TABLE enrollments (
    student_id INT,
    course_id INT,
    FOREIGN KEY (student_id) REFERENCES students(id),
    FOREIGN KEY (course_id) REFERENCES courses(id)
);
-----------------------------------------------------------------------------------------

=========================================================================================
# 12. Foreign Key vs Primary Key
=========================================================================================
PRIMARY KEY:
- Table ‡¶ï‡ßá uniquely identify ‡¶ï‡¶∞‡ßá
- NULL ‚ùå
- One per table

FOREIGN KEY:
- ‡¶Ö‡¶®‡ßç‡¶Ø table ‡¶è‡¶∞ PK reference ‡¶ï‡¶∞‡ßá
- NULL ‚úî (unless restricted)
- Multiple allowed

=========================================================================================
# 13. Foreign Key With NULL
=========================================================================================
-----------------------------------------------------------------------------------------
INSERT INTO orders (user_id, product)
VALUES (NULL, 'Guest Order');
-----------------------------------------------------------------------------------------

‚úî Allowed (by default)
- NULL ‡¶Æ‡¶æ‡¶®‡ßá relationship ‡¶®‡ßá‡¶á

=========================================================================================
# 14. Common Mistakes
=========================================================================================
‚ùå Foreign Key ‡¶®‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ  
‚ùå Wrong ON DELETE option  
‚ùå Parent delete ‡¶Ü‡¶ó‡ßá child delete ‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ  
‚ùå Soft delete + CASCADE mix ‡¶ï‡¶∞‡¶æ  

=========================================================================================
# 15. Real-Life Use Cases
=========================================================================================
‚úî User ‚Üí Orders  
‚úî Author ‚Üí Books  
‚úî Customer ‚Üí Payments  
‚úî Department ‚Üí Employees  
‚úî Product ‚Üí Reviews  

=========================================================================================
# 16. Best Practices (PRO LEVEL üî•)
=========================================================================================
‚úî Always use Foreign Key  
‚úî Decide ON DELETE carefully  
‚úî Index Foreign Key columns  
‚úî Use Soft Delete thoughtfully  
‚úî Keep naming convention clean  

=========================================================================================
# 17. Final Takeaway
=========================================================================================
- Foreign Key database relationship ‡¶è‡¶∞ backbone
- Data integrity ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßá
- CASCADE powerful but dangerous
- Real-world apps ‡¶è MUST
- Interview + Production = Core concept

=========================================================================================
                                    THE END
=========================================================================================
